# Rails Relations

---

# Disclaimer: Slides by Rafi
#### Salman is not accountable for typos (or puns)

NOTE: Probably delete this slide later
---

# Relationships?

* Kind of, but call them *relations*
* A way to relate two classes
* Example: a User has many Tweets
* Example: every Tweet belongs to a User

---

# But why?

* Often, when we want to know things about related models
* Example: Show who a particular tweet came from
* Example: Show all of a user's tweets
* Example: Show all of a tweet's hash tags

---

# Many kinds of relations

We'll go through them one by one

---

# One to one

* A User *has one* Account
* An Account *belongs to* a User
* A *one to one* relation

---

# One to many

* A User *has many* Tweets
* A Tweet *belongs to* a User
* A *one to many* relation

---

# Many to many

* A Tweet *has many* HashTags
* A HashTag *belongs to many* Tweets
* A *many to many* relation

---

# Many to many 

* We might also say:
  * A HashTag *has many* Tweets
  * A Tweet *belongs to many* HashTags
* In the many to many case, the terminology is reversable
  * This is **not true** for the others!

---

# Has and belongs to many

* We might even say a Tweet *has and belongs to many* HashTags
* And HashTag *has and belongs to many* Tweets

---

# Many to one?

Same as one to many

---

# Visualizing relations

NOTE: Use the board. Start by drawing out one-to-one, then one-to-many, then many-to-many. Use arrows and boxes, as you might actually visualize when building an application

---

# Cool! How do they work in the database?

Press down (Rafi knows how to do vertical slides)

--

# Belongs_to

![Belongs to](/images/slides/8A/belongs_to.png)

--

# Has_one

![Has one](/images/slides/8A/has_one.png)

--

# Has_many

![Has many](/images/slides/8A/has_many.png)

--

# Has_and_belongs_to_many

![Has and belongs to many](/images/slides/8A/has_and_belongs_to_many.png)

---

# Hold up: Through

Sometimes, you want to specify that a model has many of A, but *as a result* of having some of B.

* A Shopper has one Cart
* A Cart has many Items
* Therefore, a Shopper has many Items, *through* Cart

NOTE: Do some more boardwork here

---

![Has many through](/images/slides/8A/has_many_through.png)

---

# But...so what?

After setting this up, Rails gives you many methods for free

---

### Using relations (belongs_to)

```ruby
> user.tweets
# => Array of tweets
> tweet = user.tweets.first
> tweet.user
# => A user

> user.tweets << Tweet.new(:body => "I <3 relations")

> tweet.user = User.new(:name => "RubyL0v3r")
```

---

# Let's use them!
     
     
Code along, children, as we build Twitter yet again

NOTE: Back to Twitter. Give tweet.rb a belongs_to, and show how to use t.belongs_to in database migration. Then give user.rb a has_many and ask, do we need anything in the database?

---

# I want to know more

[guides.rubyonrails.org/association_basics.html](http://guides.rubyonrails.org/association_basics.html)

--- 

# EXERCISES

[http://iexperience.github.io/exercises/8A.html](http://iexperience.github.io/exercises/8A.html)
